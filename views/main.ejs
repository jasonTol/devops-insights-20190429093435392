<!DOCTYPE html>
<html lang="en-us">

    <head>
        <title>DemoDRA - Current Weather</title>

        <link rel="stylesheet" href="/built/css/default.css" />

        <script src="/bower_components/angular/angular.js"></script>
        <script src="/bower_components/angular-route/angular-route.js"></script>
        <script src="/js/controllers.js"></script>
    </head>

    <body>
        <div float="left">
            <% include includes/mainbody %>
        </div>
        
        <div id="map"></div>
    </body>

    <script>
         angular.element(document).ready(function() {
            angular.bootstrap(document, ['ConsoleModule']);
        });
    </script>
    <script>
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: -39.0363124, lng: 177.4120491},
          zoom: 4
        });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDv2CHpNWSEDzJRczO8KYtuHv5I3zb6n3Q&callback=initMap"
    async defer></script>
    <script>
    	//document.getElementById("zip1lon").addEventListener('change', addMarker());
    
	    alert("addMarker method ENGAGED");
	    
	    function addMarker(){
	    	var newLat = document.getElementById("zip1lat").value;
	    	var newLon = document.getElementById("zip1lon").value;
	    	var newCity = document.getElementById("zip1city").value;
	    	
	    	var myLatLng = {lat: newLat, lng: newLon};
	    	
	    	var marker = new google.maps.Marker({
			    position: myLatLng,
			    map: map,
			    title: newCity
	  		});
	    }
	    
	    
		
		window.onload = function() {
	
		    var target = document.getElementById("zip1lon");
		
		    var observer = new MutationObserver(function(mutations) {
		      mutations.forEach(function(mutation) {
		        addMarker();
		      });
		    });
		
		    var config = {
		      childList: true,
		      subtree: true,
		      characterData: true
		    };
		
			// Starts listening for changes in the latitude div HTML element of the page.
		    observer.observe(target, config);
	  	}
    </script>

</html>